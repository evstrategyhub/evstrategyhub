"use strict";(()=>{var t={};t.id=419,t.ids=[419],t.modules={323:(t,e,a)=>{a.a(t,async(t,r)=>{try{a.r(e),a.d(e,{default:()=>d});var n=a(7587),i=a(6556),s=a(9485),o=t([i]);async function u(t){if(!t||!t.data||!Array.isArray(t.data))return 0;let e=t.data.map(t=>({id:t.id,name:t.name,league_id:t.league_id,season_id:t.season_id,stage_id:t.stage_id,round_id:t.round_id,starting_at:t.starting_at,starting_at_timestamp:t.starting_at_timestamp,venue_id:t.venue_id,state_id:t.state_id,state:1===t.state_id?"Programado":5===t.state_id?"Finalizado":`Estado ${t.state_id}`,result_info:t.result_info,length:t.length,has_odds:t.has_odds,has_premium_odds:t.has_premium_odds}));if(0===e.length)return 0;let{error:a}=await n.N.from("fixtures").upsert(e,{onConflict:"id"});if(a)throw Error(`Error al almacenar fixtures: ${a.message}`);return e.length}async function d(t,e){try{(0,s.fH)("Iniciando prueba de actualizaci\xf3n de fixtures...");let t=new Date,a=new Date(t);a.setDate(t.getDate()+7);let r=t.toISOString().split("T")[0],o=a.toISOString().split("T")[0];(0,s.fH)(`Obteniendo fixtures entre ${r} y ${o}...`);let d=await (0,i.At)(r,o),c=await u(d);return(0,s.SW)(`Prueba completada: ${c} fixtures procesados`),await n.N.from("update_logs").insert({entity_type:"fixtures",operation_type:"test_update",status:"success",records_affected:c,created_at:new Date().toISOString()}),e.status(200).json({success:!0,processedCount:c,message:`Fixtures actualizados: ${c}`})}catch(t){return(0,s.vV)("Error en la prueba:",t),await n.N.from("update_logs").insert({entity_type:"fixtures",operation_type:"test_update",status:"error",error_message:t.message,created_at:new Date().toISOString()}),e.status(500).json({success:!1,error:t.message})}}i=(o.then?(await o)():o)[0],r()}catch(t){r(t)}})},3480:(t,e,a)=>{t.exports=a(5600)},3939:t=>{t.exports=require("@supabase/supabase-js")},5035:t=>{t.exports=import("node-fetch")},5600:t=>{t.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(t,e)=>{Object.defineProperty(e,"M",{enumerable:!0,get:function(){return function t(e,a){return a in e?e[a]:"then"in e&&"function"==typeof e.then?e.then(e=>t(e,a)):"function"==typeof e&&"default"===a?e:void 0}}})},6556:(t,e,a)=>{a.a(t,async(t,r)=>{try{a.d(e,{At:()=>o,ZN:()=>c,bE:()=>l,iL:()=>u,wK:()=>d});var n=a(5035),i=t([n]);async function s(t,e={}){let a=`https://api.sportmonks.com/v3/football/${t}`,r=Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&"),i=r?`${a}?${r}`:a;try{let t=await (0,n.default)(i,{headers:{Authorization:"OFni7bARihvquALzUS9p2PqhZHgy2t2DWHjgFperwEwxwxSm5DD5doL1gXEj"}});if(!t.ok)throw Error(`Error en la respuesta de la API: ${t.status} ${t.statusText}`);return await t.json()}catch(e){throw console.error(`Error al obtener datos de ${t}:`,e),e}}function o(t,e){return s(`fixtures/between/${t}/${e}`)}function u(t){return s(`fixtures/${t}`,{include:"predictions"})}function d(t){return s(`fixtures/${t}`,{include:"odds"})}function c(t=1){return s("teams",{page:t})}function l(t=1){return s("leagues",{include:"country",page:t})}n=(i.then?(await i)():i)[0],r()}catch(t){r(t)}})},7587:(t,e,a)=>{a.d(e,{N:()=>r});let r=(0,a(3939).createClient)("https://nxhvjyfvdirhplgfpdkm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54aHZqeWZ2ZGlyaHBsZ2ZwZGttIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0MDkzNzI1OCwiZXhwIjoyMDU2NTEzMjU4fQ.tflcdU-SgN-ODFXuimdEfAdvDDlvMoRNCqWZirYCj9Y")},7822:(t,e,a)=>{a.a(t,async(t,r)=>{try{a.r(e),a.d(e,{config:()=>c,default:()=>d,routeModule:()=>l});var n=a(3480),i=a(8667),s=a(6435),o=a(323),u=t([o]);o=(u.then?(await u)():u)[0];let d=(0,s.M)(o,"default"),c=(0,s.M)(o,"config"),l=new n.PagesAPIRouteModule({definition:{kind:i.A.PAGES_API,page:"/api/test-functions",pathname:"/api/test-functions",bundlePath:"",filename:""},userland:o});r()}catch(t){r(t)}})},8667:(t,e)=>{Object.defineProperty(e,"A",{enumerable:!0,get:function(){return a}});var a=function(t){return t.PAGES="PAGES",t.PAGES_API="PAGES_API",t.APP_PAGE="APP_PAGE",t.APP_ROUTE="APP_ROUTE",t.IMAGE="IMAGE",t}({})},9485:(t,e,a)=>{function r(t){console.log(`[INFO] [${new Date().toISOString()}] ${t}`)}function n(t,e){console.error(`[ERROR] [${new Date().toISOString()}] ${t}`,e)}function i(t){console.log(`[SUCCESS] [${new Date().toISOString()}] ${t}`)}a.d(e,{SW:()=>i,fH:()=>r,vV:()=>n})}};var e=require("../../webpack-api-runtime.js");e.C(t);var a=e(e.s=7822);module.exports=a})();