"use strict";(()=>{var e={};e.id=253,e.ids=[253],e.modules={3480:(e,r,t)=>{e.exports=t(5600)},3939:e=>{e.exports=require("@supabase/supabase-js")},4347:(e,r,t)=>{t.r(r),t.d(r,{config:()=>u,default:()=>s,routeModule:()=>m});var a={};t.r(a),t.d(a,{default:()=>l});var i=t(3480),o=t(8667),n=t(6435),d=t(7587);async function l(e,r){if("GET"!==e.method)return r.status(405).json({error:"M\xe9todo no permitido"});try{let{id:t}=e.query;if(!t)return r.status(400).json({error:"Se requiere el ID del partido"});let{data:a,error:i}=await d.N.from("fixtures").select("*").eq("id",t).single();if(i)throw i;if(!a)return r.status(404).json({error:"Partido no encontrado"});let{data:o,error:n}=await d.N.from("odds").select(`
        *,
        bookmaker:bookmaker_id(id, name),
        market:market_id(id, name)
      `).eq("fixture_id",t);if(n)throw n;let{data:l,error:s}=await d.N.from("predictions").select("*").eq("fixture_id",t);if(s)throw s;let u=null;if(a.league_id){let{data:e,error:r}=await d.N.from("leagues").select("*").eq("id",a.league_id).single();r||(u=e)}let m={};o&&o.length>0&&o.forEach(e=>{let r=e.bookmaker_id,t=e.market_id;m[r]||(m[r]={id:e.bookmaker?.id,name:e.bookmaker?.name,markets:{}}),m[r].markets[t]||(m[r].markets[t]={id:e.market?.id,name:e.market?.name,options:[]}),m[r].markets[t].options.push({label:e.label,value:e.value,probability:e.probability,handicap:e.handicap,total:e.total})});let c=[],p=l?.find(e=>237===e.type_id);if(p&&p.predictions_json){let e=o?.filter(e=>1===e.market_id);e&&e.length>0&&["home","draw","away"].forEach(r=>{let t=p.predictions_json[r];t&&e.forEach(e=>{if(e.label.toLowerCase()===r||"Home"===e.label&&"home"===r||"Draw"===e.label&&"draw"===r||"Away"===e.label&&"away"===r){let r=parseFloat(t)/100,a=parseFloat(e.value),i=r*(a-1)-(1-r)*1;c.push({type:e.label,bookmaker_id:e.bookmaker_id,bookmaker_name:e.bookmaker?.name,market_id:e.market_id,market_name:e.market?.name,odds:e.value,predicted_probability:t,implied_probability:(1/a*100).toFixed(2),ev:i.toFixed(4),ev_percentage:(100*i).toFixed(2)+"%"})}})})}return r.status(200).json({success:!0,data:{fixture:a,league:u,odds:m,predictions:l,ev_calculations:c}})}catch(e){return console.error("API Error:",e),r.status(500).json({success:!1,error:"Error al obtener la informaci\xf3n del partido",details:e.message})}}let s=(0,n.M)(a,"default"),u=(0,n.M)(a,"config"),m=new i.PagesAPIRouteModule({definition:{kind:o.A.PAGES_API,page:"/api/fixtures/[id]",pathname:"/api/fixtures/[id]",bundlePath:"",filename:""},userland:a})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},7587:(e,r,t)=>{t.d(r,{N:()=>a});let a=(0,t(3939).createClient)("https://nxhvjyfvdirhplgfpdkm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54aHZqeWZ2ZGlyaHBsZ2ZwZGttIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0MDkzNzI1OCwiZXhwIjoyMDU2NTEzMjU4fQ.tflcdU-SgN-ODFXuimdEfAdvDDlvMoRNCqWZirYCj9Y")},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=r(r.s=4347);module.exports=t})();